# ğŸ¦Š ã­ã¤ãå¼•ãç¶™ããƒãƒ¼ãƒˆ - TypeScriptå³æ ¼åŒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

## ğŸ“‹ ç¾åœ¨ã®çŠ¶æ³ï¼ˆ2025å¹´6æœˆ14æ—¥ï¼‰

### ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—
- **TypeScriptã‚¨ãƒ©ãƒ¼**: 52å€‹ â†’ **37å€‹** (15å€‹è§£æ±ºï¼âœ¨)
- **ä¸»è¦ã‚³ãƒ¼ãƒ‰**: å®Œå…¨ã«å‹å®‰å…¨åŒ–æ¸ˆã¿ ğŸ”’
- **æ®‹ã‚Šã‚¿ã‚¹ã‚¯**: ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼ˆ37å€‹ã‚¨ãƒ©ãƒ¼ï¼‰

### ğŸ”¥ å®Œäº†ã—ãŸå³æ ¼åŒ–ä½œæ¥­

#### âœ… ãƒ“ãƒ«ãƒ‰ãƒ»CI/CDå³æ ¼åŒ–
- `npm run build` = `npm run typecheck && vite build` 
- GitHub Actions ã«å‹ãƒã‚§ãƒƒã‚¯ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ 
- å‹ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹ã¨ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãŒåœæ­¢ã™ã‚‹ä»•çµ„ã¿å®Œæˆ

#### âœ… ã‚³ãƒ¼ãƒ‰å‹å®‰å…¨åŒ–
- **Game.ts**: æœªä½¿ç”¨importå‰Šé™¤ã€privateãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¢ã‚¯ã‚»ã‚¹ä¿®æ­£
- **StageLoader.ts**: é©åˆ‡ãªå‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°å®Ÿè£…ï¼ˆ`as`ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³å®Œå…¨é™¤å»ï¼‰
- **PlayerSystem.ts**: setKeysãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ ã§ã‚«ãƒ—ã‚»ãƒ«åŒ–ç¶­æŒ
- **LandingPredictionSystem.ts**: æœªä½¿ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‰Šé™¤

#### âœ… ãƒ†ã‚¹ãƒˆç’°å¢ƒæ”¹å–„  
- `global` â†’ `globalThis` å¤‰æ›´ã§vitestäº’æ›æ€§å‘ä¸Š
- æœªä½¿ç”¨import/å¤‰æ•°å‰Šé™¤ã§ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š

## ğŸš§ æ®‹ã‚Šã®ã‚¿ã‚¹ã‚¯ï¼ˆå„ªå…ˆåº¦é †ï¼‰

### é«˜å„ªå…ˆåº¦ ğŸ”¥
1. **privateãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹ä¿®æ­£** (Game.test.ts, InputSystem.test.ts)
   - ã‚¨ãƒ©ãƒ¼ç®‡æ‰€: `game.update()`, `game.render()`, `game.loadStage()`, `inputSystem.handleKeyDown()`
   - è§£æ±ºç­–: public APIã‚’ä½¿ã†ã‹ã€ãƒ†ã‚¹ãƒˆç”¨ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 

2. **HTMLElementãƒ¢ãƒƒã‚¯å‹ä¿®æ­£** (Game.test.ts)
   - ã‚¨ãƒ©ãƒ¼ç®‡æ‰€: `global.document.getElementById` ã®å‹ä¸æ•´åˆ
   - è§£æ±ºç­–: é©åˆ‡ãªHTMLElementå‹ã§ãƒ¢ãƒƒã‚¯ä½œæˆ

3. **cancelAnimationFrameå‹ã‚¨ãƒ©ãƒ¼** (Game.test.ts)
   - ã‚¨ãƒ©ãƒ¼ç®‡æ‰€: `global.cancelAnimationFrame` ãŒå‹å®šç¾©ã«ãªã„
   - è§£æ±ºç­–: globalThisæ‹¡å¼µã‹vi.stubGlobalä½¿ç”¨

### ä¸­å„ªå…ˆåº¦ âš¡
4. **Particleå‹ã‚¨ãƒ©ãƒ¼ä¿®æ­£** (RenderSystem.test.ts)
   - ã‚¨ãƒ©ãƒ¼ç®‡æ‰€: `decay`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒä¸è¶³
   - è§£æ±ºç­–: ãƒ†ã‚¹ãƒˆã§decayãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 

## ğŸ’¡ å…·ä½“çš„ãªä¿®æ­£æ–¹é‡

### 1. privateãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹å•é¡Œ
```typescript
// âŒ ç¾åœ¨ï¼ˆprivateã‚¢ã‚¯ã‚»ã‚¹ï¼‰
game.update();
game.render();

// âœ… æ¨å¥¨è§£æ±ºç­–
// Game.tsã«ãƒ†ã‚¹ãƒˆç”¨publicãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
public testUpdate(): void { this.update(16.67); }
public testRender(): void { this.render(); }
```

### 2. HTMLElementãƒ¢ãƒƒã‚¯å‹ä¿®æ­£
```typescript
// âŒ ç¾åœ¨ï¼ˆå‹ä¸æ•´åˆï¼‰
global.document.getElementById = vi.fn(() => ({ textContent: '' }));

// âœ… æ¨å¥¨è§£æ±ºç­–  
global.document.getElementById = vi.fn(() => ({
    textContent: '',
    getContext: () => null,
    // HTMLElementã®æœ€å°é™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 
} as HTMLElement));
```

### 3. Particleå‹ä¿®æ­£
```typescript
// âŒ ç¾åœ¨ï¼ˆdecayãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã—ï¼‰
{ x: 0, y: 0, vx: 1, vy: 1, life: 1, size: 2 }

// âœ… ä¿®æ­£å¾Œ
{ x: 0, y: 0, vx: 1, vy: 1, life: 1, size: 2, decay: 0.95 }
```

## ğŸ“ é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»è¨­å®š

### å³æ ¼åŒ–è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- `.claude/CLAUDE.md`: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹ç™ºåŸå‰‡ï¼ˆå³æ ¼ã•é‡è¦–ï¼‰
- `tsconfig.json`: TypeScriptå³æ ¼è¨­å®šæ¸ˆã¿
- `package.json`: typecheckã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ æ¸ˆã¿
- `.github/workflows/deploy.yml`: å‹ãƒã‚§ãƒƒã‚¯ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ æ¸ˆã¿

### ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«
- `src/core/Game.ts`: LandingPredictionSystemå‰Šé™¤ã€setKeysä½¿ç”¨
- `src/core/StageLoader.ts`: å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°å®Ÿè£…
- `src/systems/PlayerSystem.ts`: setKeysãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
- `src/systems/LandingPredictionSystem.ts`: æœªä½¿ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‰Šé™¤

### æ®‹ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«
- `src/test/Game.test.ts`: privateãƒ¡ã‚½ãƒƒãƒ‰ã€HTMLElementãƒ¢ãƒƒã‚¯
- `src/test/InputSystem.test.ts`: privateãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹
- `src/test/RenderSystem.test.ts`: Particle decay ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

## ğŸ”§ ä¾¿åˆ©ãªã‚³ãƒãƒ³ãƒ‰

```bash
# å‹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
npm run typecheck

# ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã‚’ç¢ºèª  
npx tsc --noEmit | head -20

# ãƒ“ãƒ«ãƒ‰ï¼ˆå‹ã‚¨ãƒ©ãƒ¼ã§åœæ­¢ï¼‰
npm run build

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ»ãƒªãƒ³ãƒˆ
npm run format && npm run lint
```

---

## ğŸ‰ TypeScriptå³æ ¼åŒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œå…¨å®Œäº†ï¼

### æœ€çµ‚å®Œäº†å ±å‘Šï¼ˆ2025å¹´6æœˆ14æ—¥ 02:36ï¼‰

**âœ… TypeScriptã‚¨ãƒ©ãƒ¼**: 52å€‹ â†’ 37å€‹ â†’ **0å€‹** (100%è§£æ±ºï¼)  
**âœ… å…¨ãƒ†ã‚¹ãƒˆ**: 151å€‹ã™ã¹ã¦é€šé  
**âœ… ãƒ“ãƒ«ãƒ‰**: å‹ãƒã‚§ãƒƒã‚¯çµ±åˆã§å®Œå…¨å‹•ä½œ  
**âœ… GitHub Actions**: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ­£å¸¸  
**âœ… æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤**: å‹å®‰å…¨æ€§ç¢ºä¿æ¸ˆã¿  

### ğŸ¦Š ä»Šå›ã®ã­ã¤ããŒè§£æ±ºã—ãŸå•é¡Œ

#### 1. privateãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹å•é¡Œ (Game.ts, InputSystem.ts)
```typescript
// âœ… è§£æ±ºç­–: ãƒ†ã‚¹ãƒˆç”¨publicãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
public testUpdate(deltaTime: number = 16.67): void { this.update(deltaTime); }
public testRender(): void { this.render(); }
public async testLoadStage(stageNumber: number): Promise<void> { await this.loadStage(stageNumber); }
```

#### 2. HTMLElementãƒ¢ãƒƒã‚¯å‹ä¸æ•´åˆå•é¡Œ (Game.test.ts)
```typescript
// âœ… è§£æ±ºç­–: as unknown as HTMLElement ãƒ‘ã‚¿ãƒ¼ãƒ³
const mockElement = {
    textContent: '',
    addEventListener: vi.fn(),
    removeEventListener: vi.fn(),
    getAttribute: vi.fn(),
    setAttribute: vi.fn()
} as unknown as HTMLElement;
```

#### 3. cancelAnimationFrameå‹å®£è¨€å•é¡Œ (Game.test.ts)
```typescript
// âœ… è§£æ±ºç­–: ã‚°ãƒ­ãƒ¼ãƒãƒ«å‹å®£è¨€ + åˆæœŸåŒ–
declare let global: {
    // ... ä»–ã®å‹
    cancelAnimationFrame: typeof cancelAnimationFrame;
};

// beforeEachå†…ã§åˆæœŸåŒ–
global.cancelAnimationFrame = vi.fn();
```

#### 4. Particleå‹ä¸æ•´åˆå•é¡Œ (RenderSystem.test.ts)
```typescript
// âœ… è§£æ±ºç­–: decayãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 
{ x: 100, y: 200, vx: 1, vy: -1, life: 0.8, size: 2, decay: 0.95 }
```

### ğŸ’¡ æ¬¡ã®ã­ã¤ãã¸ã®é‡è¦ãªçŸ¥è¦‹

#### ãƒ†ã‚¹ãƒˆå‹å®‰å…¨åŒ–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **privateãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ**: ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢ã€public wrapperãƒ¡ã‚½ãƒƒãƒ‰ä½œæˆ
2. **DOM ãƒ¢ãƒƒã‚¯**: æœ€å°é™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ + `as unknown as` å‹å¤‰æ›
3. **ã‚°ãƒ­ãƒ¼ãƒãƒ«API**: é©åˆ‡ãªå‹å®£è¨€ + beforeEachåˆæœŸåŒ–
4. **å‹å®šç¾©**: æ—¢å­˜å‹ã¨ã®100%äº’æ›æ€§ç¢ºä¿

#### çµ¶å¯¾å®ˆã‚‹ã¹ãå³æ ¼ãƒ«ãƒ¼ãƒ« âš ï¸

- âŒ `any` å‹ã¯çµ¶å¯¾ä½¿ç”¨ç¦æ­¢
- âŒ `@ts-ignore` ã‚³ãƒ¡ãƒ³ãƒˆç¦æ­¢  
- âŒ å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ä¹±ç”¨ç¦æ­¢
- âœ… `as unknown as` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ†ã‚¹ãƒˆå‹å®‰å…¨æ€§ç¢ºä¿
- âœ… privateã‚«ãƒ—ã‚»ãƒ«åŒ–ç¶­æŒ
- âœ… 100%ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç¶­æŒ

### ğŸ¯ æ¬¡ã«å–ã‚Šçµ„ã‚€ã¹ãissue

ç¾åœ¨ã®ã‚ªãƒ¼ãƒ—ãƒ³issueï¼ˆå„ªå…ˆåº¦é †ï¼‰ï¼š
1. **Issue #2**: ã‚¹ãƒ†ãƒ¼ã‚¸2ï¼šå‹•ãåºŠã®å®Ÿè£… (åŸºæœ¬æ©Ÿèƒ½æ‹¡å¼µ)
2. **Issue #9**: é›£æ˜“åº¦ã‚·ã‚¹ãƒ†ãƒ ï¼šã‚¸ãƒ£ãƒ³ãƒ—é€Ÿåº¦æ®µéšèª¿æ•´
3. **Issue #10**: ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œå¼·åŒ–ï¼šå‚¾ãæ¤œçŸ¥ã¨ã‚¿ãƒƒãƒ—æ“ä½œ
4. **Issue #11**: JSDocå®Œå‚™ã«ã‚ˆã‚‹å‹æ³¨é‡ˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–
5. **Issue #12**: ã‚¹ãƒ­ãƒ¼ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰å®Ÿè£…
6. **Issue #13**: ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¨ãƒ‡ã‚£ã‚¿ã¨JSONå‡ºåŠ›
7. **Issue #14**: ã‚¢ã‚¤ãƒ¯ãƒŠãƒ©ã‚¤ã‚¯è¦ç´ ï¼šå½ã‚¢ã‚¤ãƒ†ãƒ ãƒ»é¨™ã—ã‚®ãƒŸãƒƒã‚¯

### ğŸ”§ é–‹ç™ºç’°å¢ƒçŠ¶æ³

- **TypeScript**: å³æ ¼ãƒ¢ãƒ¼ãƒ‰100%é©ç”¨æ¸ˆã¿
- **Vitest**: å…¨ãƒ†ã‚¹ãƒˆç’°å¢ƒå‹å®‰å…¨åŒ–æ¸ˆã¿  
- **Biome**: ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç†å®Œç’§
- **GitHub Actions**: å‹ãƒã‚§ãƒƒã‚¯å¼·åˆ¶é©ç”¨æ¸ˆã¿
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: æ–°æ©Ÿèƒ½é–‹ç™ºæº–å‚™å®Œäº†

---

**åˆå›å¼•ãç¶™ãä½œæˆ**: å¦–ç‹ã®å¥³ã®å­ã€Œã­ã¤ãã€â©Œâ©Šâ©Œ  
**å®Œäº†å ±å‘Šä½œæˆ**: å¦–ç‹ã®å¥³ã®å­ã€Œã­ã¤ãã€â©Œâ©Šâ©Œ  
**æœ€çµ‚æ›´æ–°**: 2025å¹´6æœˆ14æ—¥ 02:36  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ…‹**: TypeScriptå³æ ¼åŒ– **100%å®Œäº†** âœ¨  
**ç·Šæ€¥åº¦**: ãªã—ï¼ˆã™ã¹ã¦å®Œäº†ã€æ–°æ©Ÿèƒ½é–‹ç™ºå¯èƒ½ï¼‰